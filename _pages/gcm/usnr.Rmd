---
title: "US News Rankings"
output: html_document
---

```{css, echo=F}
body {
  background-color: #2e2e2e;
  color: bisque;
}
@media screen and (prefers-color-scheme: light) {
  body {
    background-color: white;
    color: black;
  }
}
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
```

```{r, include=FALSE, echo=F}
library(dplyr, verbose = F)
library(stringr, verbose = F)
df = read.csv('usnr.csv')
```

```{r echo=F}
df %>% mutate(Dept. = ifelse(str_detect(University, 'Statistic'), 'Stat', 'Bstat/Info'),
              .after = 2) %>%
  group_by(Dept.) %>%
  mutate(Dept.Rank = rank(Rank, ties.method = 'min')) %>%
  select(-X) %>% arrange(Rank, Dept.Rank) %>%
  mutate(Results = ifelse(
    str_detect(University, 'Pennsylvania State|Purdue|North Carolina State'),
    'R',
    ifelse(
      str_detect(University, 'of Iowa|South Carolina'),
      'A',
      ifelse(
        str_detect(
          University,
          'Davis|Ohio|Rice|Colorado State|Michigan State|Pitts.|Santa Barbara|Riverside'
        ),
        'P',
        ''
      )
    )
  )) %>% knitr::kable(.)
```