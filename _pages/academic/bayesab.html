---
title: ""
permalink: /academic/bayesab
author_profile: true
---

<!doctype html>
<html lang="en">

<head>
    <title>Formulae for Bayesian A/B Testing â€“ Evan Miller</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="author" content="Jaeho Chang">
    <meta property="og:title" content="Bayesian A/B Testing Walkthrough">
    <meta property="og:description" content="A collection of closed-form equations for A/B testing binary">
    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
            equationNumbers: {
                autoNumber: "AMS"
            }
        },
        CommonHTML: {
            linebreaks: {
                automatic: true
            }
        },
        "HTML-CSS": {
            linebreaks: {
                automatic: true
            }
        },
        SVG: {
            linebreaks: {
                automatic: true
            }
        }
    });
    </script>
</head>

<body>
    <div id="content">
        <div class="article">
            <h1>Formulae for Bayesian A/B Testing: Walkthrough</h1>
            <p>
                Instructor: Jaeho Chang
            </p>
            <p>
                <a href="mailto: cjhsfl@gmail.com">cjhsfl@gmail.com</a>
            </p>
            <p>
                <em>June 12, 2020</em>
            </p>
            <p>
                <a href="https://www.evanmiller.org/bayesian-ab-testing.html">Original material</a>
            </p>

            <h3>Table of Contents</h3>
            <ol>
                <li>
                    <a href="#binary_ab">A/B testing: binary outcomes</a>
                    <ol>
                        <li>
                            <a href="#binary_ab_derivation">Derivation</a>
                        <li>
                            <a href="#binary_ab_equivalent">Equivalent Formulas</a>
                    </ol>
                <li>
                    <a href="#binary_abc">A/B/C testing: binary outcomes</a>
                    <ol>
                        <li>
                            <a href="#binary_abc_derivation">Derivation</a>
                    </ol>
            </ol>

            <hr>

            <a name="binary_ab"></a>
            <h2>A/B testing: binary outcomes</h2>

            <p>For a binary-outcome test (e.g. a test of conversion rates), the probability that B will beat A in the
                long
                run is given by:</p>
            \[
            {\rm Pr}(p_B &gt; p_A) = \sum_{i=0}^{\alpha_B-1}{\frac{B(\alpha_A+i, \beta_B +
            \beta_A)}{(\beta_B+i)B(1+i,\beta_B)B(\alpha_A,\beta_A)}}
            \]

            <p>Where:
            </p>
            <ul>
                <li>\(\alpha_A\) = 1 + \(S_A\)</li>
                <li>\(\beta_A\) = 1 + \(F_A\)</li>
                <li>\(\alpha_B\) = 1 + \(S_B\)</li>
                <li>\(\beta_B\) = 1 + \(F_B\)</li>
                <li>
                    \(B\) is the beta function. For arbitrary \(\alpha\) >0 and \(\beta\) > 0, beta function is defines
                    as:
                    \[
                    B(\alpha, \beta) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha + \beta)}.
                    \]
                </li>
            </ul>

            <a name="binary_ab_derivation"></a>
            <h3>Derivation</h3>

            <p>Suppose we have two independent experimental branches (A and B) and have a Bayesian belief for each one:
            </p>

            \[
            \begin{array}{lr}
            p_A \sim {\rm Beta}(\alpha_A, \beta_A) \\
            p_B \sim {\rm Beta}(\alpha_B, \beta_B)
            \end{array}
            \]

            <p>
                Using the pdf of the beta distribution, we can get the total probability that \(p_B\) is greater than
                \(p_A\) by integrating the joint distribution over all values for which \(p_B &gt; p_A\):
            </p>

            \[
            \begin{equation}
            {\rm Pr}(p_B &gt; p_A) = \int_0^1 {\rm Pr}(p_B>p_A|p_A){\rm Pr}(p_A)dp_A
            = \int_0^1 \int_{p_A}^1 {\rm Pr}(p_B|p_A)dp_B{\rm Pr}(p_A)dp_A\\
            = \int_0^1 \int_{p_A}^1 \frac{p_A^{\alpha_A-1}(1-p_A)^{\beta_A-1}}{B(\alpha_A, \beta_A)}
            \frac{{p_B}^{\alpha_B-1}(1-p_B)^{\beta_B-1}}{B(\alpha_B, \beta_B)} dp_B dp_A
            \end{equation}
            \]
        </div>
    </div>
</body>

</html>